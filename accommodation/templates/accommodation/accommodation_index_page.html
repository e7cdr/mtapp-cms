{# accommodation/accommodation_index_page.html #}

{% extends "base.html" %}
{% load static i18n wagtailcore_tags %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/layout.css' %}"/>
<link rel="stylesheet" href="{% static 'css/card_style.css' %}"/>
{% endblock extra_css %}

{% block content %}
{% block body_content %}
{% for block in page.body_content %}
{% include_block block %}
{% endfor %}
{% endblock body_content %}

<div class="layout">
    <div class="area-2">
        <!-- Filter Form -->
        <form id="filterForm" method="get">
            <select name="type">
                <option value="">All Types</option>
                <option value="glamping" {% if request.GET.type == 'glamping' %}selected{% endif %}>Glamping</option>
                <option value="cabin" {% if request.GET.type == 'cabin' %}selected{% endif %}>Cabins</option>
                <option value="hostel" {% if request.GET.type == 'hostel' %}selected{% endif %}>Hostels</option>
                <option value="campsite" {% if request.GET.type == 'campsite' %}selected{% endif %}>Campsites</option>
                <option value="hotel" {% if request.GET.type == 'hotel' %}selected{% endif %}>Hotels</option>
            </select>

            <select name="destination">
                <option value="">All Destinations</option>
                {% for dest in unique_destinations %}
                    <option value="{{ dest }}" {% if request.GET.destination == dest %}selected{% endif %}>{{ dest }}</option>
                {% endfor %}
            </select>

            <button type="submit">Filter</button>
            <a href="{% pageurl page %}" id="clearFilters">Clear</a>
        </form>
    </div>

    <div class="area-3">
        <div id="resultsContainer">
            {% for acc in accommodations_pag %}
            <div class="card">
                <h3>{{ acc.name }}</h3>
                <p>{{ acc.destination }} â€¢ {{ acc.specific|capfirst }}</p>
            </div>
            {% endfor %}
        </div>

        <nav class="pagination-nav" data-has-next="{% if accommodations_pag.has_next %}true{% else %}false{% endif %}">
            {% if accommodations_pag.has_previous %}
                <a href="?page={{ accommodations_pag.previous_page_number }}{% if request.GET.urlencode %}&{{ request.GET.urlencode }}{% endif %}">Previous</a>
            {% endif %}
            Page {{ accommodations_pag.number }} of {{ accommodations_pag.paginator.num_pages }}
            {% if accommodations_pag.has_next %}
                <a href="?page={{ accommodations_pag.next_page_number }}{% if request.GET.urlencode %}&{{ request.GET.urlencode }}{% endif %}">Next</a>
            {% endif %}
        </nav>
    </div>
</div>
{% endblock content %}

<script src="{% static 'js/filtering_index.js' %}"></script>