{% load i18n static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/pricing_options.css' %}">
{% endblock extra_css %}

<div class="pricing-options-container">
  <div class="pricing-header">
    <h2>{% trans "Pricing Options" %}</h2>
  </div>

  <div class="pricing-summary">
    <p><strong>{% trans "Adults" %}:</strong> {{ number_of_adults }} •
       <strong>{% trans "Children" %}:</strong> {{ number_of_children }} •
       <strong>{% trans "Infants" %}:</strong> {{ number_of_infants }}</p>
  </div>

    <p class="text-muted small mt-3 mb-4 text-center">
      <strong class="badge cheapest">Cheapest</strong> = lowest total price for your group.<br>
      <strong class="badge recommended">Recommended</strong> = best balance: good value, minimal extra rooms, and efficient use of beds.
  </p>

  <div id="pricing-grid" class="pricing-grid">
    {% for config in configurations %}
    <label class="pricing-card {% if config.cheapest %}cheapest{% endif %} {% if config.recommended %}recommended{% endif %} {% if forloop.first %}selected{% endif %}"
           data-index="{{ forloop.counter0 }}">

      <input type="radio" name="pricing_config" id="config-{{ forloop.counter0 }}"
             class="select-radio" value="{{ forloop.counter0 }}"
             {% if forloop.first %}checked{% endif %}>

      <div class="card-content">
        <!-- Price row -->
        <div class="price-row">
          <span class="price-amount">{{ config.total_price|floatformat:0 }}</span>
          <span class="price-currency">{{ config.currency|default:"USD" }}</span>
        </div>

        <!-- Badges -->
        <div class="badges">
          {% if config.cheapest %}
            <span class="badge cheapest">{% trans "Cheapest" %}</span>
          {% endif %}
          {% if config.recommended and not config.cheapest %}
            <span class="badge recommended">{% trans "Recommended" %}</span>
          {% endif %}
        </div>

        <!-- Compact room info -->
        <div class="room-info">
          Total Rooms: {{ config.total_rooms }}  <br>
          {% if config.singles > 0 %}{{ config.singles }}× Single{% endif %}
          {% if config.doubles > 0 %}{{ config.doubles }}× Double{% endif %}
          {% if config.triples > 0 %}{{ config.triples }}× Triple{% endif %}
        </div>

        <!-- Visual selected indicator (CSS-only) -->
        <div class="selected-indicator text-center mt-2 small fw-bold text-success" style="display: none;">
          {% trans "Selected" %}
        </div>
      </div>
    </label>
    {% empty %}
    <p class="text-center py-6 text-gray-500">{% trans "No options available" %}</p>
    {% endfor %}
  </div>

  <!-- Pagination -->
  <div class="pagination" id="pagination-controls" style="display: none;">
    <button class="prev" id="prev-page" disabled>{% trans "Previous" %}</button>
    <span id="page-info">Page 1 of 1</span>
    <button class="next" id="next-page" disabled>{% trans "Next" %}</button>
  </div>
</div>  


<script>
document.addEventListener('DOMContentLoaded', function() {
    const radios = document.querySelectorAll('input[name="pricing_config"]');
    radios.forEach(radio => {
        radio.addEventListener('change', function() {
            document.getElementById('selected_configuration').value = this.value;
        });
    });
});
</script>