<!-- Updated confirm_proposal.html (full partial with form inside, fixed trans tags, proper structure) -->
{% load static i18n wagtailimages_tags custom_filters %}

<!-- Prop ID Preview -->
<div class="alert alert-light text-center mb-4">
    <small>{% trans "Your tracking code will be generated upon confirmation." %}</small>
</div>

<!-- Tour Information (readonly) -->
<div class="card mb-4">
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                {% if tour.cover_image %}
                    {% image tour.cover_image fill-300x200 as tour_img %}
                    <img src="{{ tour_img.url }}" class="img-fluid mb-3" 
                    loading="lazy"
                    height=""
                    width=""
                    alt="{{ tour.name }}">
                {% endif %}
                <h6>{{ tour.name }}</h6>
            </div>
            <div class="col-md-6">
                <p><strong>{% trans "Start Date" %}</strong>: {{ form_data.travel_date }}</p>
                {% if tour.duration_days %}
                    <p><strong>{% trans "Duration" %}</strong>: {{ tour.duration_days }} {% trans "days" %}</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Customer Information (readonly) -->
<div class="card mb-4">
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <p><strong>{% trans "Name" %}</strong>: {{ form_data.customer_name }}</p>
                <p><strong>{% trans "Email" %}</strong>: {{ form_data.customer_email }}</p>
                <p><strong>{% trans "Phone" %}</strong>: {{ form_data.customer_phone }}</p>
            </div>
            <div class="col-md-6">
                <p><strong>{% trans "Address" %}</strong>: {{ form_data.customer_address }}</p>
                <p><strong>{% trans "Nationality" %}</strong>: {{ form_data.nationality }}</p>
                <p><strong>{% trans "Notes" %}</strong>: {{ form_data.notes }}</p>
            </div>
        </div>
    </div>
</div>

<!-- Party Size (readonly) -->
<div class="card mb-4">
    <div class="card-body">
        <p><strong>{% trans "Adults" %}</strong>: {{ form_data.number_of_adults }}</p>
        <p><strong>{% trans "Children" %}</strong>: {{ form_data.number_of_children }}</p>
        {% if form_data.child_ages %}
            <p><strong>{% trans "Child Ages" %}</strong>: {{ form_data.child_ages|join:", " }}</p>
        {% endif %}
        <p><strong>{% trans "Infants" %}</strong>: {{ form_data.number_of_infants|default:0 }}</p>
    </div>
</div>

<!-- Selected Room Config (readonly) -->
{% if tour_type != 'day' and selected_room_config %}
    <div class="card mb-4">
        <div class="card-body">
            <ul class="list-unstyled">
                {% if selected_room_config.singles %}
                    <li><strong>{% trans "Single Rooms" %}</strong>: {{ selected_room_config.singles }}</li>
                {% endif %}
                {% if selected_room_config.doubles %}
                    <li><strong>{% trans "Double Rooms" %}</strong>: {{ selected_room_config.doubles }}</li>
                {% endif %}
                {% if selected_room_config.triples %}
                    <li><strong>{% trans "Triple Rooms" %}</strong>: {{ selected_room_config.triples }}</li>
                {% endif %}
                <li><strong>{% trans "Total Estimated Price" %}</strong>: {{ form_data.currency|default:"USD" }} {{ form_data.estimated_price|floatformat:2 }}</li>
            </ul>
        </div>
    </div>
{% endif %}

<!-- Error Handling -->
{% if error %}
<div class="alert alert-danger text-center">
    {{ error }}
</div>
{% else %}
<div id="confirmationForm" data-action="{{ submit_url }}">
{% csrf_token %}
<input type="hidden" name="confirm" value="true">
<input type="hidden" name="form_submission" value="booking">
<input type="hidden" name="selected_configuration" value="{{ selected_configuration_index|default:'0' }}">
</div>
{% endif %}
]
