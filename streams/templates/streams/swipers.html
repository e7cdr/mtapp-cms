{% load static wagtailimages_tags custom_filters wagtailcore_tags %}
{% block extra_css %}
<style>
    .youtube-lazy {
        background: #000 url('https://img.youtube.com/vi/{{ item.yt_vid }}/maxresdefault.jpg') center center no-repeat;
        background-size: cover;
        cursor: pointer;
    }
    .play-button {
        position: absolute;
        top: 50%; left: 50%;
        width: 68px; height: 48px;
        margin-left: -34px; margin-top: -24px;
        background: rgba(0,0,0,0.7) url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="68" height="48" viewBox="0 0 68 48"><path d="M66.52 7.74c-.78-2.93-3.09-5.24-6.02-6.02C55.79 0 34 0 34 0S12.21 0 7.49 1.72c-2.93.78-5.24 3.09-6.02 6.02C0 12.21 0 24 0 24s0 11.79 1.72 17.49c.78 2.93 3.09 5.24 6.02 6.02C12.21 48 34 48 34 48s21.79 0 26.51-1.72c2.93-.78 5.24-3.09 6.02-6.02C68 34.79 68 24 68 24s0-11.79-1.48-17.26z" fill="%23f00"/><path d="M45 24l-18-12v24z" fill="%23fff"/></svg>') center center no-repeat;
        background-size: 100%;
        border-radius: 50%;
        pointer-events: none;
    }

    .youtube-thumb {
        cursor: pointer;
    }
    .thumb-play-icon {
        position: absolute;
        top: 50%; left: 50%;
        width: 68px; height: 48px;
        margin-left: -34px; margin-top: -24px;
        background: rgba(0,0,0,0.7) url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 48"><path d="M66.52 7.74c-.78-2.93-3.09-5.24-6.02-6.02C55.79 0 34 0 34 0S12.21 0 7.49 1.72c-2.93.78-5.24 3.09-6.02 6.02C0 12.21 0 24 0 24s0 11.79 1.72 17.49c.78 2.93 3.09 5.24 6.02 6.02C12.21 48 34 48 34 48s21.79 0 26.51-1.72c2.93-.78 5.24-3.09 6.02-6.02C68 34.79 68 24 68 24s0-11.79-1.48-17.26z" fill="%23f00"/><path d="M45 24l-18-12v24z" fill="%23fff"/></svg>') center center no-repeat;
        background-size: 100%;
        border-radius: 50%;
        pointer-events: none;
        transition: transform 0.2s;
    }
    .youtube-thumb:hover .thumb-play-icon {
        transform: scale(1.1);
    }
</style>
{% endblock extra_css %}

{% if self.variations == 'thumbnail' %}
<section>
    <div class="swiper thumb-swiper1-container">
        {% if self.swiper_title %}
        <h1> {{ self.swiper_title }} </h1>
        {% endif %}
        <div class="swiper-wrapper">
            {% for item in value.images %}
            <div class="swiper-slide">
                {% if item.image %}
                <a href="{% if item.link %}{{ item.link }}{% else %}{% url 'wagtail_serve' '' %}{% endif %}">
                {% image item.image fill-1920x1080 format-webp webpquality-80 alt="{{ item.caption|default:'Swiper images' }}" id="slide-{{ forloop.counter }}" loading="lazy" %}
                </a>
                {% elif item.yt_vid %}
                <div class="youtube-lazy" data-video-id="{{ item.yt_vid }}"
                    style="width:100%; height:100%; background:#000; position:relative;">
                    <div class="play-button">Play</div>
                </div>
                {% endif %}
            </div>
            {% empty %}
                <p>No images found. Please go to the admin panel to add them.</p>
            {% endfor %}
        </div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>
    <div class="swiper thumb-swiper2-container">
        <div class="swiper-wrapper">
            {% for item in value.images %}
            <div class="swiper-slide">
                {% if item.image %}
                {% image item.image fill-1920x1080 format-webp webpquality-80 alt="{{ item.caption|default:'Swiper images' }}" id="slide-{{ forloop.counter }}" loading="lazy" %}
                {% elif item.yt_vid %}
                <div class="youtube-thumb" style="position:relative; display:inline-block; width:100%; height:100%;">
                    <img 
                        src="https://i.ytimg.com/vi/{{ item.yt_vid }}/hqdefault.jpg" 
                        alt="YouTube video"
                        height=""
                        width=""
                        loading="lazy"
                        style="width:100%; height:100%; object-fit:cover;"
                        onerror="this.src='https://i.ytimg.com/vi/{{ item.yt_vid }}/mqdefault.jpg'">
                    <div class="thumb-play-icon"></div>
                </div>
                {% endif %}
            </div>
            {% empty %}
                <p>No images found. Please go to the admin panel to add them.</p>
            {% endfor %}
        </div>            
    </div>
</section>
{% elif self.variations == 'basic' %}
<section>
    <div class="basic-swiper-container swiper">
        {% if self.swiper_title %}
        <h1>{{ self.swiper_title }}</h1>
        {% endif %}
        <div class="swiper-wrapper">
            {% for item in value.images %}
                <div class="swiper-slide">
                    {% if item.image %}
                    {% image item.image fill-1920x1080 format-webp webpquality-80 alt="{{ item.caption|default:'Swiper images' }}" id="slide-{{ forloop.counter }}" loading="lazy" %}
                    {% endif %}
                </div>
            {% empty %}
                <p>No images found. Please go to the admin panel to add them.</p>
            {% endfor %}
        </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>
<script src="{% static 'js/swipers/basic_swiper.js' %}"></script>
</section>
{% elif self.variations == 'framed' %}
 <section>
    <div class="framed-swiper-container">
        {% if self.swiper_title %}
        <h1>{{ self.swiper_title }}</h1>
        {% endif %}
        <div class="swiper-wrapper">
            {% for item in value.images %}
            <div class="swiper-slide">
                {% if item.image %}
                {% image item.image fill-370x315 format-webp webpquality-80 alt="Swiper images" id="slide-{{ forloop.counter }}" loading="lazy" %}
                {% endif %}
                {% if item.caption %}
                <p class="framed-caption">{{ item.caption }}</p>
                {% endif %}
            </div>
            {% empty %}
                <p>No images found. Please go to the admin panel to add them.</p>
            {% endfor %}
        </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
        <svg>
            <filter id="mask">
                <feturbulence x="0" y="0" baseFrequency="0.02" numOctaves="5" seed="6"></feturbulence>
                <feDisplacementMap in="SourceGraphic" scale="20" />
            </filter>
        </svg>
        </div>
</section>
{% elif self.variations == 'collage' %}
<!--Collage Swiper-->
<section class="collage-grid-container">
    <div class="swiper collage-swiper1-container">
        {% if self.swiper_title %}
        <h1 class="collage-title">{{ self.swiper_title }}</h1>
        {% endif %}
        <div class="swiper-wrapper">
            {% for item in value.images %}
            <div class="swiper-slide">
                    {% if item.image %}
                    {% image item.image fill-1920x1080 format-webp webpquality-80 alt="{{ item.caption|default:'Swiper images' }}" id="slide-{{ forloop.counter }}" loading="lazy" %}
                {% elif item.yt_vid %}
                <div class="youtube-lazy"
                data-video-id="{{ item.yt_vid }}" data-volume="50"
                style="position:absolute; inset:0; background:#000;">
                <div style="position:absolute; inset:0; background:url('https://i.ytimg.com/vi/{{ item.yt_vid }}/maxresdefault.jpg') center/cover no-repeat; filter:brightness(0.7);"></div>
                <div style="position:absolute; inset:0; display:flex; align-items:center; justify-content:center; pointer-events:none;">
                    <div style="width:100px; height:100px; background:rgba(255,255,255,0.2); backdrop-filter:blur(20px); border-radius:50%; border:4px solid rgba(255,255,255,0.4); box-shadow:0 20px 40px rgba(0,0,0,0.5);"></div>
                </div>
            </div>
            {% endif %}
        </div>
            {% if item.caption %}
            <p class="caption">{{ item.caption }}</p>
            {% endif %}
            {% empty %}
            <p>No images found. Please go to the admin panel to add them.</p>
            {% endfor %}
        </div>
        <div class="swiper-nav">
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>     
        </div> 
    </div>
    <div class="swiper collage-swiper2-container">
        <div class="swiper-wrapper grid-thumb">
            {% for item in value.images %}
                <div class="swiper-slide">
                    {% if item.image %}
                    {% image item.image fill-1920x1080 format-webp webpquality-80 alt="Thumbnail Images" id="slide-{{ forloop.counter }}" loading="lazy" %}
                    {% elif item.yt_vid %}
                    <img height="" width="" src="https://i.ytimg.com/vi/{{ item.yt_vid }}/hqdefault.jpg"
                    alt="YouTube thumbnail"
                    loading="lazy"
                    style="width:100%; height:100%; object-fit:cover; border-radius:8px;">
                    {% endif %}
                </div>
            {% empty %}
                <p>No images found. Please go to the admin panel to add them.</p>
            {% endfor %}
        </div>
    </div>
</section>
{% elif self.variations == 'coverflow' %}
<section class="coverflow-swiper-container swiper">
        <div class="swiper-wrapper">
                {% for item in value.images %}
                <div class="swiper-slide">
                    <a href="{% if item.link %}{{ item.link }}{% else %}{% url 'wagtail_serve' '' %}{% endif %}">
                    {% if item.image %}
                    {% image item.image fill-1920x1080 format-webp webpquality-80 alt="{{ item.caption|default:'Swiper images' }}" id="slide-{{ forloop.counter }}" loading="lazy" %}
                    <p class="caption">{{ item.caption }}</p>
                    {% endif %}
                </a>
                </div>
                {% endfor %}
            </div>
        <div class="navigation">
            <div class="swiper-pagination"></div>
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
        </div>
</section>
{% elif self.variations == 'fade' %}
<section>
    <div class="fade-swiper-container swiper">
        <div class="swiper-wrapper">
            {% for item in value.images %}
            <div class="swiper-slide">
                <a href="{% if item.link %}{{ item.link }}{% else %}{% url 'wagtail_serve' '' %}{% endif %}">
                {% if item.image %}
                {% image item.image fill-1920x1080 format-webp webpquality-80 alt="{{ item.caption|default:'Swiper images' }}" id="slide-{{ forloop.counter }}" loading="lazy" %}
                </a>
                {% if item.caption %}
                <p class="caption">{{ item.caption }}</p>
                {% endif %}
                {% elif item.yt_vid %}
                <div class="youtube-lazy"
                data-video-id="{{ item.yt_vid }}"
                style="position:absolute; inset:0; background:#000;">
                <div style="position:absolute; inset:0; background:url('https://i.ytimg.com/vi/{{ item.yt_vid }}/maxresdefault.jpg') center/cover no-repeat; filter:brightness(0.7);"></div>
                <div style="position:absolute; inset:0; display:flex; align-items:center; justify-content:center; pointer-events:none;">
                    <div style="width:90px; height:90px; background:rgba(255,255,255,0.15); backdrop-filter:blur(20px); border-radius:50%; border:3px solid rgba(255,255,255,0.3);"></div>
                </div>
            </div>
            {% endif %}
        </div>
            {% endfor %}
        </div>
    <div class="swiper-pagination"></div>
    </div>
</section>
{% endif %}
